{% load staticfiles %}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="">

    <title>Analíticas</title>

    <link rel="stylesheet" type="text/css" href="/static/css/bootstrap.min.css" media="screen,projection">
    <link rel="stylesheet" type="text/css" href="/static/css/dataTables.bootstrap.css" media="screen,projection">
    <link rel="stylesheet" type="text/css" href="/static/css/base.css" media="screen,projection">
    <style>
        table, tr, td, th, tbody, thead, tfoot {
        page-break-inside: avoid !important;
        }
    </style>
</head>
<body>
<div class="container">
    <div class="row">
        <div class="col-md-12">
            <div class="breadcrumb">
                <img src="{{ logo }}" width="80">
                <span style="margin: 6px auto;" class="pull-right">Fecha de emisión: {{ date | date:"SHORT_DATE_FORMAT"}}</span>
            </div>
                <span class="pull-right" style="padding: 70px;">
                        {% if case.picture %}
                            <img src="{{ case_picture }}"
                                 class="img-circle img-responsive" width="100px" height="100px">
                        {% elif case.bank.company.logo %}
                            <img src="{{ company_logo }}"
                                 class="img-circle img-responsive" width="100px" height="100px">
                        {% else %}
                            <img src="{{ default_avatar }}"
                                 class="img-circle img-responsive" width="100px" height="100px">
                        {% endif %}
                </span>
            <h2>Análisis del Caso</h2>
            <p><b>Nombre:</b> {{ case.name }}</p>
            <p><b>ID:</b> {{ case.id }}</p>
            <p><b>Monto Faltante:</b> {{ case.missing_amount }}</p>
            <p><b>Cantidad de ATMs afectados:</b> {{ case.atms.count }}</p>
            <p><b>Fecha:</b> {{ case.created_date }}</p>
            <p><b>Cliente:</b> {{ case.bank }}</p>
            <br>
            <div class="panel panel-primary">
                <div class="panel-heading">
                    <h2 class="panel-title">Archivos logs</h2>
                </div>
                <div class="panel-body">
                    <table class="table table-hover" id="error-table">
                        <thead>
                        <tr>
                            <th>Nombre del archivo</th>
                            <th>Fecha creación</th>
                        </tr>
                        </thead>
                        <tbody>
                        <tr>
                            <td>archivo1</td>
                            <td>2013-06-02</td>
                        </tr>
                        <tr>
                            <td>archivo2</td>
                            <td>2013-06-02</td>
                        </tr>
                        </tbody>
                    </table>
                </div>
            </div>
            <div class="row">
                <h2>Reporte Ejecutivo</h2>
                <div class="col-md-4 col-xs-4">
                    <h5 style="font-size: 10px;">Cantidad de transacciones</h5>
                    <div class="well percent-result text-center">{{ meta.transactions_number }}</div>
                </div>
                <div class="col-md-4 col-xs-4">
                    <h5 style="font-size: 10px;">Monto total de transacciones validas</h5>
                    <div class="well percent-result text-center">{{ meta.amount.valid_transactions }} {{ currency }}
                    </div>
                </div>
                <div class="col-md-4 col-xs-4">
                    <h5 style="font-size: 10px;">Transacciones con errores críticos</h5>
                    <div class="well percent-result text-center">{{ meta.errors.critics_number }}</div>
                </div>
                <div class="col-md-4 col-xs-4">
                    <h5 style="font-size: 10px;">Porcentaje transacciones de errores críticos</h5>
                    <div class="well percent-result text-center">{{ meta.errors.critics_number_percentage }} %</div>
                </div>
                <div class="col-md-4 col-xs-4">
                    <h5 style="font-size: 10px;">Monto transacciones con errores criticos</h5>
                    <div class="well percent-result text-center">{{ meta.amount.critical_errors_transactions }}
                        {{ currency }}
                    </div>
                </div>
                <div class="col-md-4 col-xs-4">
                    <h5 style="font-size: 9px;">Monto transacciones con errores importantes</h5>
                    <div class="well percent-result text-center">{{ meta.amount.important_errors_transactions }} {{
                        currency }}
                    </div>
                </div>
            </div>
            <div class="row">
                <h3>Estimación de porcentaje de culpa</h3>
                <div class="col-md-4 col-xs-4">
                    <h5>Logs Journal</h5>
                    <div class="well percent-result text-center">33%</div>
                </div>
                <div class="col-md-4 col-xs-4">
                    <h5>Logs Windows</h5>
                    <div class="well percent-result text-center">100%</div>
                </div>
                <div class="col-md-4 col-xs-4">
                    <h5>Estimación del caso</h5>
                    <div class="well percent-result text-center">98%</div>
                </div>
            </div>
            <br>
            <h2>Reporte Técnico</h2>
            <h4>Analista: {{ analyst_name }}</h4>
            {% if resolution %}
            <p><b>Resolución:</b></p>
            <div class="form-group">
                    <textarea class="form-control" readonly>
                        {{ resolution|first }}
                    </textarea>
            </div>
            {% endif %}
            <br>
            {% if operations_table %}
            <div class="panel panel-primary">
                <div class="panel-heading">
                    <h2 class="panel-title">Operaciones</h2>
                </div>
                <div class="panel-body">
                    <table class="table table-hover">
                        <thead>
                        <tr>
                            <th>Fecha</th>
                            <th>Error</th>
                            <th>Monto</th>
                        </tr>
                        </thead>
                        <tbody>
                        {% for row in operations_table %}
                        <tr>
                            {% for col in row %}
                            <td>
                                {{ col }}
                            </td>
                            {% endfor %}
                        </tr>
                        {% endfor %}
                        </tbody>
                    </table>
                </div>
            </div>
            {% endif %}
            <br>
            <h5>Gráficas:</h5>
            <div class="row" style="padding-top: 35px; padding-bottom: 70px;">
                <div class="col-md-6 col-xs-6">
                    <img src="{{ atm_index_chart }}"
                         style="width: 100%; height: 140px; margin: 0px auto; max-height: 200px; position: relative;"/>
                </div>
                <div class="col-md-6 col-xs-6">
                    <img src="{{ total_operations_report_chart }}"
                         style="width: 100%; height: 140px; margin: 0px auto; max-height: 200px; position: relative;"/>
                </div>
            </div>
            <div class="col-md-4 col-xs-4">
                <h6>Errores Criticos</h6>
                <img src="{{ critical_errors_chart }}"
                     style="width: 100%; height: 200px; margin: 0px auto; max-height: 200px; position: relative;"/>
            </div>
            <div class="col-md-4 col-xs-4">
                <h6>Errores Importantes</h6>
                <img src="{{ important_errors_chart }}"
                     style="width: 100%; height: 200px; margin: 0px auto; max-height: 200px; position: relative;"/>
            </div>
            <div class="col-md-4 col-xs-4">
                <h6>Transacciones sin problemas</h6>
                <img src="{{ no_errors_chart }}"
                     style="width: 100%; height: 200px; margin: 0px auto; max-height: 200px; position: relative;"/>
            </div>
            <div class="col-md-12 col-xs-12">
                <h5>Reporte de Operaciones</h5>
                <img src="{{ operations_report_chart }}"
                     style="width: 100%; height: 300px; margin: 0px auto; max-height: 280px; position: relative;"/>
            </div>
            <div class="col-md-12 col-xs-12">
                <h5>Timeline</h5>
                <img src="{{ chart_events_timeline }}"
                     style="width: 100%; margin: 0px auto; max-height: 20000px; position: relative;"/>
            </div>
            {% if time_line_table %}
            <div class="col-md-12 col-xs-12" style="padding-top: 10px;">
                <div class="panel panel-primary">
                    <div class="panel-heading">
                        <h2 class="panel-title">Timeline</h2>
                    </div>
                    <div class="panel-body">
                        <table class="table table-hover" style="font-size: 14px;">
                            <thead>
                            <tr>
                                <th>Fecha</th>
                                <th>Error</th>
                                <th>Monto</th>
                            </tr>
                            </thead>
                            <tbody>
                            {% for row in time_line_table %}
                            <tr>
                                {% for col in row %}
                                <td>
                                    {{ col }}
                                </td>
                                {% endfor %}
                            </tr>
                            {% endfor %}
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
            {% endif %}
        </div>
    </div>
</div>
<br>
</body>
</html>